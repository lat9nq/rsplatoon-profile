<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>r/Splatoon Profile</title>
	<meta http-equiv="Content-Security-Policy" content="default-src * gap: data: blob: 'unsafe-inline' 'unsafe-eval' ws: wss:;">

	<meta name="description" content="r/Splatoon profile pages - share your friend code and game stats!">
	<meta name="keywords" content="Splatoon, r/Splatoon, friend code, profile">
	<meta name="author" content="shane#1353">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="apple-touch-icon" sizes="180x180" href="/fav/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/fav/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/fav/favicon-16x16.png">
	<link rel="manifest" href="/fav/site.webmanifest">
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="/css/root.css">
</head>
<body>
	<div class="container" style="margin-bottom:100px;padding-left:0;padding-right:0;">
		<div class="jumbotron">
			<div>
				<a href="https://discord.gg/rsplatoon" target="_blank">
					<img class="center-block" src="/css/img/logo.png" style="width:300px;height:auto;margin-top:0"/>
				</a>
				<h1>Manage Settings</h1>
			</div>
            <% if (id) { %>
				<div id="userinfo">
					<div class="usermenu" style="display: none;">
						<div style="height:70px;width:1px;"></div>
						<div class="item">
							<a href="/settings">
								Settings
							</a>
						</div>
						<div class="item">
							<form action="/delete" method="post">
								<input type="hidden" name="delete" value="YES" />
								<a href="#" onclick="$(this).closest('form').submit();return false;">
									Delete Profile
								</a>
							</form>
						</div>
						<div class="item">
							<a href="/logout">
								Logout
							</a>
						</div>
					</div>
					<img src="<%= avatar %>" onclick="toggleusermenu()" />
					<script>
						function toggleusermenu() {
							$(".usermenu").slideToggle();
						}
					</script>
				</div>
            <% } %>
			<a class="btn btn-primary" href="/" role="button">Home</a>
		</div>
		<div>
			<div class="container">
				<% if (isAdmin) { %>
					<div class="row">
						<div class="col">
							<form action="/settings/grantkey" method="post" id="save-form">
								<div class="form-group">
									<div>
										<h3 for="name">Grant bot key to another user</h3>
										<input type="text" class="form-control" name="name" value="" id="name" placeholder="User ID" />
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value="getProfile" name="permissions" style="width:auto">
										<label class="form-check-label" for="flexCheckDefault">
											Get Profile
										</label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value="saveFriendCode" name="permissions" style="width:auto">
										<label class="form-check-label" for="flexCheckDefault">
											Save Friend Code
										</label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value="saveUsername" name="permissions" style="width:auto">
										<label class="form-check-label" for="flexCheckDefault">
											Save Username
										</label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value="saveDrip" name="permissions" style="width:auto">
										<label class="form-check-label" for="flexCheckDefault">
											Save Drip
										</label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" value="deleteProfile" name="permissions" style="width:auto">
										<label class="form-check-label" for="flexCheckDefault">
											Delete Profile
										</label>
									</div>
									<button id="submit" type="submit" class="btn btn-primary">Save</button>
								</div>
							</form>
						</div>
					</div>
					<div class="row no-gutters" style="margin-top:14px;">
						<div class="col">
							<div class="container" style="padding:0">
								<div class="row no-gutters">
									<div class="col">
										<table class="table table-striped">
											<thead>
												<tr>
													<th scope="col">User</th>
													<th scope="col">Get Profile</th>
													<th scope="col">Save FC</th>
													<th scope="col">Save Name</th>
													<th scope="col">Save Drip</th>
													<th scope="col">Delete Profile</th>
													<th scope="col">Revoked</th>
													<th scope="col">Update</th>
													<th scope="col">Reset</th>
													<th scope="col">Revoke</th>
											  	</tr>
											</thead>
											<tbody>
												<% if (allbots && allbots.length) { %>
													<% for (var i = 0; i < allbots.length; i++) { %>
														<tr>
															<form action="/settings/updatekey" method="post">
																<th scope="row">
																	<%= allbots[i].userId %>
																	<input type="hidden" name="name" value="<%= allbots[i].userId %>" />
																</th>
																<td>
																	<div class="form-check">
																		<input type="hidden" name="getProfile" value="0" />
																		<input class="form-check-input" type="checkbox" value="1" name="getProfile" style="width:auto" <%= (allbots[i].getProfile) ? 'checked' : '' %>>
																	</div>
																</td>
																<td>
																	<div class="form-check">
																		<input type="hidden" name="saveFriendCode" value="0" />
																		<input class="form-check-input" type="checkbox" value="1" name="saveFriendCode" style="width:auto" <%= (allbots[i].saveFriendCode) ? 'checked' : '' %>>
																	</div>
																</td>
																<td>
																	<div class="form-check">
																		<input type="hidden" name="saveUsername" value="0" />
																		<input class="form-check-input" type="checkbox" value="1" name="saveUsername" style="width:auto" <%= (allbots[i].saveUsername) ? 'checked' : '' %>>
																	</div>
																</td>
																<td>
																	<div class="form-check">
																		<input type="hidden" name="saveDrip" value="0" />
																		<input class="form-check-input" type="checkbox" value="1" name="saveDrip" style="width:auto" <%= (allbots[i].saveDrip) ? 'checked' : '' %>>
																	</div>
																</td>
																<td>
																	<div class="form-check">
																		<input type="hidden" name="deleteProfile" value="0" />
																		<input class="form-check-input" type="checkbox" value="1" name="deleteProfile" style="width:auto" <%= (allbots[i].deleteProfile) ? 'checked' : '' %>>
																	</div>
																</td>
																<td>
																	<%= allbots[i].nobot %>
																</td>
																<td>
																	<button class="btn btn-primary" type="submit"><i class="fa fa-cloud-upload"></i></button>
																</td>
															</form>
															<td class="text-center">
																<form action="/settings/resetkey" method="post">
																	<input type="hidden" name="name" value="<%= allbots[i].userId %>" />
																	<button class="btn btn-primary" type="submit"><i class="fa fa-refresh"></i></button>
																</form>
															</td>
															<td class="text-center">
																<form action="/settings/revokekey" method="post">
																	<input type="hidden" name="name" value="<%= allbots[i].userId %>" />
																	<button class="btn btn-primary" type="submit"><i class="fa fa-times"></i></button>
																</form>
															</td>
														</tr>
													<% } %>
												<% } %>
											</tbody>
										  </table>
									</div>
								</div>
							</div>
						</div>
					</div>
				<% } %>
				<% if (botKey) { %>
					<div class="row">
						<div class="col-11">
							<form>
								<label for="copy-input">Your Bot Key</label>
								<div class="input-group" onclick="copyToClipboard()">
									  <input type="text" class="form-control"
										  value="<%= botKey %>" id="copy-input" readonly>
									  <span class="input-group-btn">
										<button class="btn btn-default" type="button" id="copy-button"
											data-toggle="tooltip" data-placement="button"
											title="Copy to Clipboard">
											  <i class="fa fa-copy"></i>
										</button>
									  </span>
								</div>
								<script>
									function copyToClipboard() {
										console.log("going");
										$("#copy-input").focus();
										$("#copy-input").select();
										document.execCommand("copy");
									}
								</script>
							</form>
						</div>
						<div class="col-1">
							<form action="/settings/resetkey" method="post">
								<button class="btn btn-primary" type="submit" style="bottom:4px;position:absolute;"><i class="fa fa-refresh"></i></button>
							</form>
						</div>
					</div>
				<% } %>
			</div>
		</div>
	</div>
</body>
</html>